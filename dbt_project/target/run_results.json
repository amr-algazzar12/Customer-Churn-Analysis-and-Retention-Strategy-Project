{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.8.7", "generated_at": "2025-11-30T18:37:29.917973Z", "invocation_id": "a21895f1-1e19-4198-8f33-02ba48405b3d", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.754260Z", "completed_at": "2025-11-30T18:37:29.761735Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.762411Z", "completed_at": "2025-11-30T18:37:29.762434Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00935053825378418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.customer_churn.Telco_customer_churn", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.765402Z", "completed_at": "2025-11-30T18:37:29.768668Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.769184Z", "completed_at": "2025-11-30T18:37:29.769199Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.004930257797241211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.customer_churn.stg_customers", "compiled": true, "compiled_code": "/*\nStaging: Clean and rename columns\n*/\n\nwith source as (\n    select * from \"churn\".\"main_raw\".\"Telco_customer_churn\"\n),\n\ncleaned as (\n    select\n        -- IDs\n        \"customerID\" as customer_id,\n        \n        -- Location\n        \"Count\" as count_value,\n        \"Country\" as country,\n        \"State\" as state,\n        \"City\" as city,\n        \"Zip Code\" as zip_code,\n        \"Lat Long\" as lat_long,\n        \"Latitude\" as latitude,\n        \"Longitude\" as longitude,\n        \n        -- Demographics\n        \"Gender\" as gender,\n        \"Senior Citizen\" as is_senior_citizen,\n        \"Partner\" as has_partner,\n        \"Dependents\" as has_dependents,\n        \n        -- Account\n        \"Tenure Months\" as tenure_months,\n        \"Contract\" as contract_type,\n        \"Paperless Billing\" as has_paperless_billing,\n        \"Payment Method\" as payment_method,\n        \n        -- Services\n        \"Phone Service\" as has_phone_service,\n        \"Multiple Lines\" as has_multiple_lines,\n        \"Internet Service\" as internet_service_type,\n        \"Online Security\" as has_online_security,\n        \"Online Backup\" as has_online_backup,\n        \"Device Protection\" as has_device_protection,\n        \"Tech Support\" as has_tech_support,\n        \"Streaming TV\" as has_streaming_tv,\n        \"Streaming Movies\" as has_streaming_movies,\n        \n        -- Financial\n        \"Monthly Charges\" as monthly_charges,\n        \"Total Charges\" as total_charges,\n        \"CLTV\" as customer_lifetime_value,\n        \n        -- Churn\n        \"Churn Label\" as churn_label,\n        \"Churn Value\" as churn_value,\n        \"Churn Score\" as churn_score,\n        \"Churn Reason\" as churn_reason\n        \n    from source\n)\n\nselect * from cleaned", "relation_name": "\"churn\".\"main_staging\".\"stg_customers\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.777366Z", "completed_at": "2025-11-30T18:37:29.818263Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.822229Z", "completed_at": "2025-11-30T18:37:29.822242Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.051177978515625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.customer_churn.int_customer_features", "compiled": true, "compiled_code": "/*\nIntermediate: Encode features for ML\n*/\n\nwith customers as (\n    select * from \"churn\".\"main_staging\".\"stg_customers\"\n),\n\nfeatures as (\n    select\n        customer_id,\n        \n        -- Location (keep original)\n        count_value,\n        country,\n        state,\n        city,\n        zip_code,\n        lat_long,\n        latitude,\n        longitude,\n        \n        -- Demographics (encoded: 0/1)\n        case when gender = 'Male' then 1 else 0 end as gender_encoded,\n        case when is_senior_citizen = 'Yes' then 1 else 0 end as senior_citizen_encoded,\n        case when has_partner = 'Yes' then 1 else 0 end as partner_encoded,\n        case when has_dependents = 'Yes' then 1 else 0 end as dependents_encoded,\n        \n        -- Tenure\n        tenure_months,\n        \n        -- Phone services\n        case when has_phone_service = 'Yes' then 1 else 0 end as phone_service_encoded,\n        case \n            when has_multiple_lines = 'Yes' then 2\n            when has_multiple_lines = 'No' then 1\n            else 0\n        end as multiple_lines_encoded,\n        \n        -- Internet services (0=no internet, 1=no service, 2=yes)\n        case \n            when internet_service_type = 'Fiber optic' then 2\n            when internet_service_type = 'DSL' then 1\n            else 0\n        end as internet_service_encoded,\n        \n        case \n            when has_online_security = 'Yes' then 2\n            when has_online_security = 'No' then 1\n            else 0\n        end as online_security_encoded,\n        \n        case \n            when has_online_backup = 'Yes' then 2\n            when has_online_backup = 'No' then 1\n            else 0\n        end as online_backup_encoded,\n        \n        case \n            when has_device_protection = 'Yes' then 2\n            when has_device_protection = 'No' then 1\n            else 0\n        end as device_protection_encoded,\n        \n        case \n            when has_tech_support = 'Yes' then 2\n            when has_tech_support = 'No' then 1\n            else 0\n        end as tech_support_encoded,\n        \n        case \n            when has_streaming_tv = 'Yes' then 2\n            when has_streaming_tv = 'No' then 1\n            else 0\n        end as streaming_tv_encoded,\n        \n        case \n            when has_streaming_movies = 'Yes' then 2\n            when has_streaming_movies = 'No' then 1\n            else 0\n        end as streaming_movies_encoded,\n        \n        -- Contract\n        case \n            when contract_type = 'Two year' then 2\n            when contract_type = 'One year' then 1\n            else 0\n        end as contract_encoded,\n        \n        case when has_paperless_billing = 'Yes' then 1 else 0 end as paperless_billing_encoded,\n        \n        -- Payment method\n        case \n            when payment_method like '%Credit card%' then 3\n            when payment_method like '%Bank transfer%' then 2\n            when payment_method like '%Mailed check%' then 1\n            else 0\n        end as payment_method_encoded,\n        \n        -- Financial\n        monthly_charges,\n        total_charges,\n        customer_lifetime_value,\n        churn_score,\n        \n        -- Target\n        churn_value as churn\n        \n    from customers\n)\n\nselect * from features", "relation_name": "\"churn\".\"main_intermediate\".\"int_customer_features\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.783454Z", "completed_at": "2025-11-30T18:37:29.821569Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.823871Z", "completed_at": "2025-11-30T18:37:29.823882Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.04795718193054199, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.not_null_stg_customers_tenure_months.2c240dd663", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect tenure_months\nfrom \"churn\".\"main_staging\".\"stg_customers\"\nwhere tenure_months is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.790086Z", "completed_at": "2025-11-30T18:37:29.823289Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.825289Z", "completed_at": "2025-11-30T18:37:29.825296Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.05019426345825195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.not_null_stg_customers_customer_id.e2cfb1f9aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"churn\".\"main_staging\".\"stg_customers\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.812896Z", "completed_at": "2025-11-30T18:37:29.824610Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.827323Z", "completed_at": "2025-11-30T18:37:29.827345Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.05064678192138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.unique_stg_customers_customer_id.c7614daada", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"churn\".\"main_staging\".\"stg_customers\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.832868Z", "completed_at": "2025-11-30T18:37:29.853447Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.855455Z", "completed_at": "2025-11-30T18:37:29.855468Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.026903390884399414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.customer_churn.fct_customer_churn", "compiled": true, "compiled_code": "/*\nMarts: Final ML-ready dataset\n*/\n\n\n\nwith features as (\n    select * from \"churn\".\"main_intermediate\".\"int_customer_features\"\n),\n\nfinal as (\n    select\n        -- ID (for reference)\n        customer_id,\n        \n        -- Location features\n        count_value as \"Count\",\n        country as \"Country\",\n        state as \"State\", \n        city as \"City\",\n        zip_code as \"Zip Code\",\n        lat_long as \"Lat Long\",\n        latitude as \"Latitude\",\n        longitude as \"Longitude\",\n        \n        -- Encoded features (matching training data column names)\n        gender_encoded as \"Gender\",\n        senior_citizen_encoded as \"Senior Citizen\",\n        partner_encoded as \"Partner\",\n        dependents_encoded as \"Dependents\",\n        tenure_months as \"Tenure Months\",\n        phone_service_encoded as \"Phone Service\",\n        multiple_lines_encoded as \"Multiple Lines\",\n        internet_service_encoded as \"Internet Service\",\n        online_security_encoded as \"Online Security\",\n        online_backup_encoded as \"Online Backup\",\n        device_protection_encoded as \"Device Protection\",\n        tech_support_encoded as \"Tech Support\",\n        streaming_tv_encoded as \"Streaming TV\",\n        streaming_movies_encoded as \"Streaming Movies\",\n        contract_encoded as \"Contract\",\n        paperless_billing_encoded as \"Paperless Billing\",\n        payment_method_encoded as \"Payment Method\",\n        monthly_charges as \"Monthly Charges\",\n        total_charges as \"Total Charges\",\n        customer_lifetime_value as \"CLTV\",\n        \n        -- Target (NO LEAKAGE FEATURES!)\n        churn as \"Churn Label\"\n        \n    from features\n    where customer_id is not null\n)\n\nselect * from final", "relation_name": "\"churn\".\"main_marts\".\"fct_customer_churn\""}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.836350Z", "completed_at": "2025-11-30T18:37:29.854249Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.856316Z", "completed_at": "2025-11-30T18:37:29.856327Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0272367000579834, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.accepted_values_int_customer_features_gender_encoded__0__1.77a91d09c6", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        gender_encoded as value_field,\n        count(*) as n_records\n\n    from \"churn\".\"main_intermediate\".\"int_customer_features\"\n    group by gender_encoded\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.844772Z", "completed_at": "2025-11-30T18:37:29.854828Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.857530Z", "completed_at": "2025-11-30T18:37:29.857540Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.027281761169433594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.not_null_int_customer_features_churn.80fb6a3298", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect churn\nfrom \"churn\".\"main_intermediate\".\"int_customer_features\"\nwhere churn is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.849344Z", "completed_at": "2025-11-30T18:37:29.857068Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.859772Z", "completed_at": "2025-11-30T18:37:29.859779Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.0280148983001709, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.not_null_int_customer_features_customer_id.26798febce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"churn\".\"main_intermediate\".\"int_customer_features\"\nwhere customer_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.865366Z", "completed_at": "2025-11-30T18:37:29.882836Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.884843Z", "completed_at": "2025-11-30T18:37:29.884854Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.023807764053344727, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.unique_int_customer_features_customer_id.98bc039cfd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"churn\".\"main_intermediate\".\"int_customer_features\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.869759Z", "completed_at": "2025-11-30T18:37:29.883589Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.886138Z", "completed_at": "2025-11-30T18:37:29.886146Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.024547100067138672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.accepted_values_fct_customer_churn__Churn_Label___0__1.a0ad3a30ce", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        \"Churn Label\" as value_field,\n        count(*) as n_records\n\n    from \"churn\".\"main_marts\".\"fct_customer_churn\"\n    group by \"Churn Label\"\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    '0','1'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.874490Z", "completed_at": "2025-11-30T18:37:29.884146Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.886926Z", "completed_at": "2025-11-30T18:37:29.886935Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.024169921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.not_null_fct_customer_churn__Churn_Label_.81e11a10bc", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"Churn Label\"\nfrom \"churn\".\"main_marts\".\"fct_customer_churn\"\nwhere \"Churn Label\" is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.878799Z", "completed_at": "2025-11-30T18:37:29.885686Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.888390Z", "completed_at": "2025-11-30T18:37:29.888397Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.02414846420288086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.not_null_fct_customer_churn__Monthly_Charges_.2ac9fdc7d0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"Monthly Charges\"\nfrom \"churn\".\"main_marts\".\"fct_customer_churn\"\nwhere \"Monthly Charges\" is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.902210Z", "completed_at": "2025-11-30T18:37:29.907893Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.909165Z", "completed_at": "2025-11-30T18:37:29.909178Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017642736434936523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.unique_fct_customer_churn_customer_id.133fe97e4c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_id as unique_field,\n    count(*) as n_records\n\nfrom \"churn\".\"main_marts\".\"fct_customer_churn\"\nwhere customer_id is not null\ngroup by customer_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.893676Z", "completed_at": "2025-11-30T18:37:29.908455Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.910420Z", "completed_at": "2025-11-30T18:37:29.910430Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.020107746124267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.not_null_fct_customer_churn__Tenure_Months_.ccc856eb2e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect \"Tenure Months\"\nfrom \"churn\".\"main_marts\".\"fct_customer_churn\"\nwhere \"Tenure Months\" is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-11-30T18:37:29.897900Z", "completed_at": "2025-11-30T18:37:29.911629Z"}, {"name": "execute", "started_at": "2025-11-30T18:37:29.912546Z", "completed_at": "2025-11-30T18:37:29.912556Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0215303897857666, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.customer_churn.not_null_fct_customer_churn_customer_id.0259e621be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"churn\".\"main_marts\".\"fct_customer_churn\"\nwhere customer_id is null\n\n\n", "relation_name": null}], "elapsed_time": 0.3330235481262207, "args": {"write_json": true, "defer": false, "exclude": [], "partial_parse_file_diff": true, "macro_debugging": false, "select": [], "cache_selected_only": false, "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "/workspaces/Customer-Churn-Analysis-and-Retention-Strategy-Project/dbt_project", "printer_width": 80, "quiet": false, "log_format": "default", "indirect_selection": "eager", "require_resource_names_without_spaces": false, "log_level": "info", "static": false, "introspect": true, "log_file_max_bytes": 10485760, "print": true, "source_freshness_run_project_hooks": false, "log_format_file": "debug", "log_path": "/workspaces/Customer-Churn-Analysis-and-Retention-Strategy-Project/dbt_project/logs", "vars": {}, "populate_cache": true, "send_anonymous_usage_stats": true, "log_level_file": "debug", "require_explicit_package_overrides_for_builtin_materializations": true, "partial_parse": true, "project_dir": "/workspaces/Customer-Churn-Analysis-and-Retention-Strategy-Project/dbt_project", "enable_legacy_logger": false, "strict_mode": false, "empty_catalog": false, "compile": true, "which": "generate", "show_resource_report": false, "favor_state": false, "static_parser": true, "invocation_command": "dbt docs generate", "version_check": true, "use_colors_file": true, "use_colors": true}}